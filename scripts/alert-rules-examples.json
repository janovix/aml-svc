{
	"description": "Ejemplos de reglas de alerta basadas en los requisitos de Janovix AV Vehículos",
	"rules": [
		{
			"name": "Monto igual o superior a 6,420 UMA – Aviso Obligatorio",
			"description": "Se dispara cuando el precio total del vehículo es igual o superior a 6,420 UMA. Genera aviso obligatorio al SAT.",
			"active": true,
			"severity": "HIGH",
			"ruleConfig": {
				"type": "transaction_amount_uma",
				"threshold": 6420,
				"currency": "MXN",
				"umaDailyValue": null,
				"evaluationType": "individual",
				"requiresCompleteFile": true,
				"checklist": [
					"client_identification",
					"activity_or_occupation",
					"beneficial_owner"
				]
			},
			"metadata": {
				"category": "aviso_obligatorio",
				"obligation": "generar_aviso_sat",
				"deadline": "dia_17_mes_siguiente",
				"retention": "10_anios"
			}
		},
		{
			"name": "Acumulación de operaciones que alcanza el umbral de aviso",
			"description": "Detecta cuando 2 o más operaciones de un mismo cliente suman >= 6,420 UMA en un periodo móvil de 6 meses.",
			"active": true,
			"severity": "HIGH",
			"ruleConfig": {
				"type": "aggregate_amount_uma",
				"threshold": 6420,
				"currency": "MXN",
				"umaDailyValue": null,
				"timeWindow": "6_months",
				"timeWindowType": "rolling",
				"minTransactions": 2,
				"groupBy": "client",
				"operationTypes": ["PURCHASE", "SALE"],
				"resetAfterAviso": true
			},
			"metadata": {
				"category": "aviso_obligatorio",
				"obligation": "generar_aviso_sat",
				"detectionTypes": [
					"multiple_units_same_client",
					"payments_different_agencies",
					"third_party_payments"
				]
			}
		},
		{
			"name": "Intento de pago en efectivo superior al monto permitido",
			"description": "Se dispara cuando el cliente intenta pagar en efectivo una cantidad mayor a la permitida para esta actividad vulnerable.",
			"active": true,
			"severity": "HIGH",
			"ruleConfig": {
				"type": "cash_payment_limit",
				"maxCashAmount": null,
				"currency": "MXN",
				"action": "reject"
			},
			"metadata": {
				"category": "pago_efectivo",
				"obligation": "rechazo_operacion",
				"legalBasis": "Art_32_LFPIORPI"
			}
		},
		{
			"name": "Sistema detecta fraccionamiento de efectivo",
			"description": "Detecta cuando el cliente usa múltiples depósitos en efectivo o diferentes personas realizan depósitos en efectivo a nombre del comprador.",
			"active": true,
			"severity": "MEDIUM",
			"ruleConfig": {
				"type": "cash_fragmentation",
				"detectionWindow": "30_days",
				"minCashPayments": 2,
				"checkMultiplePayers": true,
				"checkSameBuyer": true
			},
			"metadata": {
				"category": "pago_efectivo",
				"obligation": "rechazo_operacion",
				"risk": "estructuracion"
			}
		},
		{
			"name": "El pagador no coincide con el comprador",
			"description": "Janovix detecta cuando el pagador no coincide con el comprador, indicando posible riesgo de testaferro.",
			"active": true,
			"severity": "MEDIUM",
			"ruleConfig": {
				"type": "payer_buyer_mismatch",
				"requireEnhancedDueDiligence": true,
				"checkPaymentMethods": true
			},
			"metadata": {
				"category": "debida_diligencia",
				"obligation": "debida_diligencia_reforzada",
				"risk": "testaferro"
			}
		},
		{
			"name": "Operación de PEP por encima del umbral de aviso – seguimiento reforzado",
			"description": "Identifica cuando un cliente PEP realiza una operación por encima del umbral de aviso, requiriendo seguimiento intensificado.",
			"active": true,
			"severity": "CRITICAL",
			"ruleConfig": {
				"type": "pep_above_threshold",
				"threshold": 6420,
				"umaDailyValue": null,
				"requirePEPFlag": true,
				"requireEnhancedMonitoring": true,
				"requireManualReview": true
			},
			"metadata": {
				"category": "pep_seguimiento",
				"obligation": "seguimiento_intensificado",
				"risk": "alto_riesgo"
			}
		},
		{
			"name": "Cliente PEP o de Alto Riesgo – Seguimiento Intensificado",
			"description": "Todas las operaciones de clientes PEP o de alto riesgo requieren seguimiento intensificado y revisión manual.",
			"active": true,
			"severity": "HIGH",
			"ruleConfig": {
				"type": "pep_or_high_risk",
				"requirePEPFlag": true,
				"requireHighRiskFlag": true,
				"requireEnhancedMonitoring": true,
				"requireManualReview": true,
				"requireDocumentation": true
			},
			"metadata": {
				"category": "seguimiento_intensificado",
				"obligation": "monitoreo_estricto",
				"risk": "alto_riesgo"
			}
		},
		{
			"name": "Operaciones frecuentes en corto plazo",
			"description": "Detecta cuando un cliente realiza múltiples operaciones en un corto período, posible estructuración o intento de evasión de umbrales.",
			"active": true,
			"severity": "MEDIUM",
			"ruleConfig": {
				"type": "frequent_transactions",
				"timeWindow": "30_days",
				"minTransactions": 3,
				"requireAccumulationCheck": true
			},
			"metadata": {
				"category": "operaciones_inusuales",
				"risk": "estructuracion"
			}
		},
		{
			"name": "Cliente sin historial adquiriendo vehículo de muy alto valor",
			"description": "Cliente sin historial previo que adquiere un vehículo de muy alto valor, indicando posible riesgo de lavado de activos.",
			"active": true,
			"severity": "HIGH",
			"ruleConfig": {
				"type": "new_client_high_value",
				"minTransactionAmount": null,
				"requireNoPreviousTransactions": true,
				"requireEnhancedDueDiligence": true,
				"requireResourceDocumentation": true
			},
			"metadata": {
				"category": "operaciones_inusuales",
				"obligation": "debida_diligencia_reforzada",
				"risk": "lavado_activos"
			}
		},
		{
			"name": "Uso de cuentas de terceros no relacionados",
			"description": "Detecta cuando se usan cuentas de terceros no relacionados para el pago, indicando posible uso de prestanombres.",
			"active": true,
			"severity": "HIGH",
			"ruleConfig": {
				"type": "third_party_accounts",
				"requireRelationshipCheck": true,
				"action": "reject_or_enhanced_dd"
			},
			"metadata": {
				"category": "operaciones_inusuales",
				"obligation": "rechazo_o_dd_reforzada",
				"risk": "prestanombres"
			}
		}
	],
	"notes": {
		"umaDailyValue": "Este valor debe configurarse manualmente cada año por el Representante Encargado de Cumplimiento",
		"maxCashAmount": "Debe configurarse según el límite legal para esta actividad vulnerable",
		"minTransactionAmount": "Debe configurarse según lo que se considere 'muy alto valor' para el negocio",
		"implementation": "El worker de detección de alertas debe implementar la lógica de evaluación para cada tipo de regla definido en ruleConfig.type"
	}
}
